<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Books - MyLibrary</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(to right, #E8F0FF, #DFF6FF);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .navbar {
      background: linear-gradient(to right, #1c92d2, #f2fcfe);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    .navbar-brand {
      font-weight: bold;
      font-size: 1.8rem;
      animation: dashIn 1s ease forwards;
    }
    @keyframes dashIn {
      0% { opacity: 0; transform: translateX(-100px); }
      100% { opacity: 1; transform: translateX(0); }
    }
    .container {
      flex: 1;
    }
    .card {
      border-radius: 15px;
    }
    .form-section {
      background-color: #ffffff;
      border-radius: 15px;
      padding: 20px;
    }
    .table {
      background-color: #ffffff;
      border-radius: 10px;
    }
    footer {
      background-color: #0d6efd;
      color: white;
      padding: 15px 0;
      text-align: center;
      margin-top: auto;
    }
  </style>
  <script>
    function toggleForm(mode) {
      document.getElementById('manualForm').style.display = mode === 'manual' ? 'block' : 'none';
      document.getElementById('fileForm').style.display = mode === 'file' ? 'block' : 'none';
      document.getElementById('btnManual').classList.toggle('btn-primary', mode === 'manual');
      document.getElementById('btnManual').classList.toggle('btn-outline-primary', mode !== 'manual');
      document.getElementById('btnFile').classList.toggle('btn-primary', mode === 'file');
      document.getElementById('btnFile').classList.toggle('btn-outline-primary', mode !== 'file');
    }
  </script>
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-dark px-4">
    <a class="navbar-brand" href="/">ðŸ“š MyLibrary</a>
    <div class="ms-auto d-flex gap-2">
      <a href="/dashboard" class="btn btn-outline-dark">Dashboard</a>
      <a href="/logout" class="btn btn-outline-dark">Logout</a>
    </div>
  </nav>

  <div class="container mt-4 animate__animated animate__fadeIn">
    <h3 class="text-center mb-4">ðŸ“˜ Manage Books</h3>

    <!-- Book Form Section -->
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Add Books</h5>
          <div>
            <button id="btnManual" class="btn btn-primary btn-sm me-2" onclick="toggleForm('manual')">Manual Entry</button>
            <button id="btnFile" class="btn btn-outline-primary btn-sm" onclick="toggleForm('file')">Upload Excel</button>
          </div>
        </div>

        <!-- Manual Form -->
        <form id="manualForm" method="POST" action="/add-book">
          <div class="row g-3">
            <div class="col-md-3">
              <input type="text" name="isbn" class="form-control" placeholder="ISBN" required>
            </div>
            <div class="col-md-4">
              <input type="text" name="title" class="form-control" placeholder="Book Title" required>
            </div>
            <div class="col-md-4">
              <input type="text" name="author" class="form-control" placeholder="Author Name" required>
            </div>
            <div class="col-md-1">
              <button type="submit" class="btn btn-success w-100">Add</button>
            </div>
          </div>
        </form>

        <!-- File Upload Form -->
        <form id="fileForm" method="POST" action="/upload-books" enctype="multipart/form-data" style="display: none;">
          <div class="row g-3 align-items-center mt-2">
            <div class="col-md-10">
              <input type="file" name="file" accept=".xlsx" class="form-control" required>
            </div>
            <div class="col-md-2">
              <button type="submit" class="btn btn-success w-100">Upload</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Book Table -->
    {% if books %}
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title">Books List</h5>
        <div class="table-responsive">
          <table class="table table-bordered table-hover table-striped mt-3">
            <thead class="table-dark">
              <tr>
                <th>#</th>
                <th>ISBN</th>
                <th>Title</th>
                <th>Author</th>
                <th>Available</th>
                <th>Expected Return Date</th>
                <th>Added On</th>
              </tr>
            </thead>
            <tbody>
              {% for book in books %}
              <tr>
                <td>{{ loop.index }}</td>
                <td>{{ book.isbn }}</td>
                <td>{{ book.title }}</td>
                <td>{{ book.author }}</td>
                <td>
                  {% if book.available %}
                    <span class="badge bg-success">Yes</span>
                  {% else %}
                    <span class="badge bg-danger">No</span>
                  {% endif %}
                </td>
                <td>{{ book.expected_return_date or 'â€”' }}</td>
                <td>{{ book.added_on[:10] if book.added_on }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    {% else %}
    <div class="alert alert-info mt-3">No books found in the system.</div>
    {% endif %}
  </div>

  <footer>
    <div class="container">
      <small>Â© 2025 MyLibrary â€” Book Management | Project by Rajendra</small>
    </div>
  </footer>

</body>
</html>
